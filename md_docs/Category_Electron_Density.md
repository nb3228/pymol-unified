# Category: Electron Density

## Display CCP4 Maps

The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.

The following steps can be used to read CCP4-format electron density maps into pymol for the generation of publication-quality images. 

1\. Use **fft** to create a map in CCP4. (This task can be run from the _Run_ FFT-Create Map _option under_ Map & Mask Utilities _) You can create a_ simple map or a 'Fo-Fc map as you wish. CCP4i will create a 2Fo-Fc map by default. To make a Fo-Fc map, set F1=DELFWT and PHIC=PHDELWT in the task window. Select the option to cover **'asymmetric unit'**. For pymol to read the map later, you will need to add the file extension .map.ccp4 to the generated map. You may find this map too coarse to make for a pretty diagram. You can generate a nicer (albeit much larger) map by re-running **fft** with a tighter grid spacing. I usually take the default values generated by FFT and double them. You can change grid spacing under _Infrequently Used Options_. Alternatively, you can increase the sampling rate in Pymol in step 3 below. 

2\. Open pymol and read in your PDB file. Create a selection about whatever you want to see the map around. Typically one would display the selection as sticks. 

3\. Open your map in pymol, _e.g._ mymap.map.ccp4 (you need the ccp4 extension). An object named _mymap.map_ will be created by pymol. To increase the sampling rate of the map (desirable if you did not do this at the time of map generation) issue the command **map_double mymap.map, -1**

4\. Identify a selection about which to display your map, _e.g._
    
    
    select site, resi 39-50 and resn bct
    

5\. To display the map around your selection (_e.g._ , named _site_) issue a command similar to this: 
    
    
    isomesh map, mymap.map, 2.0, site, carve=1.6
    

This command will create a mesh map object named _map_ from the object _mymap.map_ , contoured at 2.0 sigma, around the selection _site_ , within 1.6A of selected atoms. You can change the contour level and carve parameter to suit. The contour level should be about 1.00 for a 2Fo-Fc map and about 3.00 for a Fo-Fc map. Note: the map object will be named in pymol whatever the filename was minus the .ccp4 extension 

6\. For a publication quality figure the following are suggestions: 
    
    
    color grey50, map # sets map to 50% gray
    set mesh_width, 0.5 # makes meshes thinner for ray-tracing
    bg_color white #sets background to white
    set ray_trace_fog, 0 # turns off raytrace fog--optional
    set depth_cue, 0 # turns off depth cueing--optional
    set ray_shadows, off # turns off ray-tracing shadows
    ray 1024,1024 # this would create a 1024x1024 pixel ray-traced image
    png image.png # output final image
    

Labels can be added in GIMP or Photoshop. With these directions you should be able to create an image similar to the following one: 

[![Ccp4 map.png](/images/8/8f/Ccp4_map.png)](/index.php/File:Ccp4_map.png)

# User Notes

If the ccp4 maps loaded by PyMOL seem smaller/larger than maps in other programs this might be due to normalization. To stop PyMOL from normalizing a cpp4 map simply unset, 
    
    
    unset normalize_ccp4_maps
    

**before** loading your ccp4 map. 

# See Also

[normalize_ccp4_maps](/index.php/Normalize_ccp4_maps "Normalize ccp4 maps")

Retrieved from "[https://pymolwiki.org/index.php?title=Display_CCP4_Maps&oldid=11999](https://pymolwiki.org/index.php?title=Display_CCP4_Maps&oldid=11999)"


---

## Isomesh

The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.

**isomesh** creates a mesh isosurface object from a map object. 

## Contents

  * 1 Usage
  * 2 Example
  * 3 Details
    * 3.1 Selection Argument
    * 3.2 State Arguments
    * 3.3 MAP AROUND THE CENTER
    * 3.4 MAP OUTSIDE THE CALCULATED AREA
    * 3.5 MAP LEVELS
  * 4 See Also



## Usage
    
    
    isomesh name, map, level [,(selection) [,buffer [,state [,carve ]]]] 
    

  * name = str: the name for the new mesh isosurface object.
  * map = str: the name of the map object to use for computing the mesh.
  * level = float: the contour level (in sigma units) {default: 1.0}
  * selection = str: an atom selection about which to display the mesh with an additional "buffer" (if provided).
  * buffer = float: (see selection)
  * state = int: the state into which the object should be loaded (default=1) (set state=0 to append new mesh as a new state) {default: 1}
  * carve = float: a radius about each atom in the selection for which to include density. If "carve" is not provided, then the whole brick is displayed.



## Example
    
    
    fetch 6sps
    fetch 6sps, type=2fofc
    
    # mesh for entire map object
    isomesh mesh_all, 6sps_2fofc
    
    # mesh within bounding box of ligand, enlarged by 2 Angstrom
    isomesh mesh_ligand, 6sps_2fofc, selection=(resn LR5), buffer=2
    
    # mesh only within 2 Angstrom radius of any ligand atom
    isomesh mesh_ligand_carved, 6sps_2fofc, selection=(resn LR5), carve=2
    
    set_view (\
         0.001600198,   -0.993020296,    0.117938228,\
        -0.999629617,    0.001603606,    0.027057989,\
        -0.027055763,   -0.117936097,   -0.992654920,\
         0.000000000,    0.000000000,  -55.829845428,\
        12.989342690,    2.425159931,   19.217729568,\
        51.427371979,   60.232315063,  -19.999994278 )
    

mesh_all  | mesh_ligand  | mesh_ligand_carved   
---|---|---  
[![6sps-mesh-all.png](/images/1/19/6sps-mesh-all.png)](/index.php/File:6sps-mesh-all.png) | [![6sps-mesh-ligand.png](/images/e/e4/6sps-mesh-ligand.png)](/index.php/File:6sps-mesh-ligand.png) | [![6sps-mesh-ligand-carved.png](/images/d/df/6sps-mesh-ligand-carved.png)](/index.php/File:6sps-mesh-ligand-carved.png)  
  
## Details

#### Selection Argument

The arguments `selection`, `buffer` and `carve` can limit the mesh display to a selected area, and/or extend the area by symmetry operators if the selection is located outside the map bounding box itself. 

[![Isomesh-buffer-carve.png](/images/0/04/Isomesh-buffer-carve.png)](/index.php/File:Isomesh-buffer-carve.png)

#### State Arguments

If the mesh object already exists, then the new mesh will be appended onto the object as a new state (unless you indicate a state). 

  * state > 0: specific state
  * state = 0: all states
  * state = -1: current state


  * source_state > 0: specific state
  * source_state = 0: include all states starting with 0
  * source_state = -1: current state
  * source_state = -2: last state in map



#### MAP AROUND THE CENTER

You can create mesh around the center of the view by specifying "center" as the selection argument. 
    
    
    isomesh normal, fake_map, 1.0, center
    

#### MAP OUTSIDE THE CALCULATED AREA

When [map_auto_expand_sym](/index.php/Map_auto_expand_sym "Map auto expand sym") is ON, you can create mesh beyond the precalculated volume. In this case, symmetry information (lattice constants, space group) of the model specified in the selection argument if available, or (new in 1.7) from the map object. 

#### MAP LEVELS

  * Generally speaking there is some ambiguity with visualization tools as to how map data is to treated: Some map file formats are normalized by convention (in the file data itself) and others do not. Some visualization tools automatically normalize maps upon reading, others do not. PyMOL's default behavior is dependent upon map file type: CCP4 and O/BRIX/DSN6 maps are automatically normalized upon reading (disable via **normalize_*** settings), other maps types are not. PyMOL's normalization is a straight statistical average of all map points -- this may or may not be what you want. If migrating to PyMOL from another tool, then it is definitely worth comparing how the maps are being represented by creating an equivalent figure in both, making sure that they match, and if they do not, then figuring out why not. _From the PyMOL list. Author: Warren DeLano._



## See Also

  * [isodot](/index.php/Isodot "Isodot")
  * [load](/index.php/Load "Load")
  * [fetch](/index.php/Fetch "Fetch")
  * [dynamic_mesh](/index.php/Dynamic_mesh "Dynamic mesh")



Retrieved from "[https://pymolwiki.org/index.php?title=Isomesh&oldid=13332](https://pymolwiki.org/index.php?title=Isomesh&oldid=13332)"


---

## Isosurface

The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.

**isosurface** creates a new surface object from a map object. 

## Contents

  * 1 Usage
  * 2 Algorithm
  * 3 Examples
  * 4 Notes
  * 5 See Also



## Usage
    
    
     isosurface name, map, [,level [,(selection) [,buffer [,state [,carve [,source_state [,side [,mode ]]]]]]]]
    

  * name = the name for the new mesh isosurface object.
  * map = the name of the map object to use for computing the mesh.
  * level = the contour level. (default=1.0)
  * selection = an atom selection about which to display the mesh with an additional "buffer" (if provided). (default="")
  * state = the state into which the object should be loaded (default=1) (set state=-2 to append new surface as a new state)
  * carve = a radius about each atom in the selection for which to include density. If "carve= not provided, then the whole brick is displayed. (default=None)
  * source_state = the state of the map from which the object should be loaded. (default=0)
  * Front or back face. Triangle-winding/normal direction. (default=1)
  * mode = surface geometry (0: dots; 1: lines; 2: triangle triangle-normals; 3: triangle gradient-normals) (default=3)



## Algorithm

PyMOL offers three different algorithms for isosurface generation. Each of these can be activated by the `isosurface_algorithm` setting 

  * 0: Marching Cubes via VTKm (default) (requires VTKm)
  * 1: Marching Cubes basic (fallback if VTKm not installed)
  * 2: Marching tetrahedra (legacy)



## Examples
    
    
    fetch 1oky, type=2fofc, async=0
    isosurface 1okySurf, 1oky_2fofc
    

With carving at 2 Angstrom around the molecular model: 
    
    
    fetch 1oky, async=0
    fetch 1oky, type=2fofc, async=0
    isosurface 1okySurf, 1oky_2fofc, 1.0, (1oky), carve=2.0
    

## Notes

If there exists a non-map object with the same name, then the new surface will overwrite that object. Surface objects can be appended onto existing surface objects using the aforementioned state argument. 

## See Also

  * [volume](/index.php/Volume "Volume")
  * [isodot](/index.php/Isodot "Isodot")
  * [isomesh](/index.php/Isomesh "Isomesh")
  * [load](/index.php/Load "Load")
  * [Dynamic_mesh](/index.php/Dynamic_mesh "Dynamic mesh")



Retrieved from "[https://pymolwiki.org/index.php?title=Isosurface&oldid=13432](https://pymolwiki.org/index.php?title=Isosurface&oldid=13432)"


---

## Map double

The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.

**map_double** resamples a map at twice the current resolution. The amount of memory required to store the map will increase eight-fold. 

  * [![Std. map mesh spacing](/images/a/a8/Map_normal.png)](/index.php/File:Map_normal.png "Std. map mesh spacing")

Std. map mesh spacing 

  * [![Map doubled](/images/c/c2/Map_double.png)](/index.php/File:Map_double.png "Map doubled")

Map doubled 

  * [![Map double, doubled](/images/8/8f/Map_double2.png)](/index.php/File:Map_double2.png "Map double, doubled")

Map double, doubled 

  * [![Map double, double, doubled](/images/6/63/Map_double3.png)](/index.php/File:Map_double3.png "Map double, double, doubled")

Map double, double, doubled 




# Usage
    
    
    map_double map_name [, state ]
    

# Example
    
    
    fetch 1rx1
    fetch 1rx1, type=2fofc
    map_double 1rx1_2fofc
    isomesh mesh, 1rx1_2fofc
    

## See Also

[Map_Halve](/index.php?title=Map_Halve&action=edit&redlink=1 "Map Halve \(page does not exist\)")

Retrieved from "[https://pymolwiki.org/index.php?title=Map_double&oldid=13322](https://pymolwiki.org/index.php?title=Map_double&oldid=13322)"


---

## Map Set Border

The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.

**map_set_border** is a function (reqd by PDA) which allows you to set the level on the edge points of a map 

### USAGE
    
    
    map_set_border <name>,<level>
    

### NOTES

unsupported. 

### SEE ALSO

[Load](/index.php/Load "Load")

Retrieved from "[https://pymolwiki.org/index.php?title=Map_Set_Border&oldid=8115](https://pymolwiki.org/index.php?title=Map_Set_Border&oldid=8115)"


---

## Map Trim

The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.

**Map Trim** introduced in PyMol 0.99beta11, gives the user the ability to cut out a section of a map and read it back in as a completely new map. This was not previously possible prior to 0.99beta11. (Windows build at [PyMol Beta](http://delsci.com/beta) or compile from source). 

## Usage
    
    
    map_trim map-name, selection-name, buffer
    

Combined with the convenient new object-name wildcards (!!!), you could for example trim all your maps to 3 Angstroms around ligands with one commmand as follows 
    
    
    map_trim *, organic, 3
    

With map size now reduced, the map_double command can come in handy to increase mesh density on your figure. 
    
    
    map_double *
    

Retrieved from "[https://pymolwiki.org/index.php?title=Map_Trim&oldid=8111](https://pymolwiki.org/index.php?title=Map_Trim&oldid=8111)"


---

## Normalize ccp4 maps

The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.

**Good default?** It has been suggested to change the default of this setting to **off**. If you agree or disagree, please leave a comment on the [discussion page](/index.php/Talk:Normalize_ccp4_maps "Talk:Normalize ccp4 maps"). 

The normalize_ccp4_maps settings (default: **on**) controls whether or not PyMOL normalizes the data from a ccp4 map file **upon loading**. The data is shifted and scaled so that mean=0.0 and stdev=1.0. 

Normalization is done on the raw data array, not across the unit cell. This means that if the raw data doesn't exactly cover an integral number of asymmetric units, the result will be different than for example when loading the same file into Coot, which normalizes across the cell. 

**Normalization should be turned off before loading, in cases like:**

  * the map file has already been normalized, for example with CCP4â€™s mapmask program
  * you want to specify mesh contour levels in raw units (e/A^3) instead of rmsd (sigma). This is recommended if you want to make figures that match the display in Coot.



## Usage
    
    
    # load map and normalize data
    set normalize_ccp4_maps, on
    load somemap.ccp4
    
    # load map as-is (without normalization)
    set normalize_ccp4_maps, off
    load somemap.ccp4
    

## See Also

  * [normalize_o_maps](/index.php?title=Normalize_o_maps&action=edit&redlink=1 "Normalize o maps \(page does not exist\)")
  * [normalize_grd_maps](/index.php?title=Normalize_grd_maps&action=edit&redlink=1 "Normalize grd maps \(page does not exist\)")
  * [load](/index.php/Load "Load")
  * [isomesh](/index.php/Isomesh "Isomesh")
  * [Display_CCP4_Maps](/index.php/Display_CCP4_Maps "Display CCP4 Maps")



Retrieved from "[https://pymolwiki.org/index.php?title=Normalize_ccp4_maps&oldid=11998](https://pymolwiki.org/index.php?title=Normalize_ccp4_maps&oldid=11998)"


---

## Slice

The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.

[![](/images/5/57/Slice_example_2_screenshot.png)](/index.php/File:Slice_example_2_screenshot.png)

[](/index.php/File:Slice_example_2_screenshot.png "Enlarge")

Screenshot of slice example #2

slice creates a slice object from a [map](/index.php?title=Category:Maps&action=edit&redlink=1 "Category:Maps \(page does not exist\)") object. 

## Contents

  * 1 USAGE
  * 2 ARGUMENTS
  * 3 EXAMPLES
  * 4 PYMOL API
  * 5 NOTES
  * 6 SEE ALSO
  * 7 References



## USAGE
    
    
    slice_new name, map, [state, [source_state]]
    

_or_
    
    
    slice name, map, [state, [source_state]]
    

## ARGUMENTS

  * **name** = the name for the new slice object (string)
  * **map** = the name of the map object to use for computing the slice (string)
  * **state** = the state into which the object should be loaded (default=1; set state=0 to append new mesh as a new state)
  * **source_state** = the state of the map from which the object should be loaded (default=0)



## EXAMPLES
    
    
     
    # Create a map slice plane perpendicular to current view
    slice a_new_slice, a_map
    
    
    # A more complicated example that shows how to create multiple slices
    # (in this case, 3 slices perpendicular to each other), each colored
    # with a different color ramp and different contour levels:
    
    # Reset the view, to align view on XYZ axes
    reset
    # (Optional: Adjust view direction to your liking)
    # Create a map slice *perpendicular* to the current view.
    # The slice seems to be in the center of the APBS (or other) volmap. Map "tracking" is off by default.
    slice slice_A, apbs_map
    # Rotate camera 90 degrees about the vertical axis
    turn y, 90
    # Second, perpendicular, slice
    slice slice_B, apbs_map
    # Rotate again, this time about the horizontal
    turn x, 90
    # Third slice
    slice slice_C, apbs_map
    
    # Define new color ramps: ramp_name, map_object, list of low/mid/hi values, 3 RGB triplets
    ramp_new ramp1010RWB, apbs_map, [-10,0,10], [ [1,0,0], [1,1,1], [0,0,1] ]
    ramp_new ramp11RYG, apbs_map, [-1,0,1], [ [1,0,0], [1,1,0], [0,1,0] ]
    ramp_new ramp55MltGO, apbs_map, [-5,0,5], [ [0,1,1], [0.5,1,0.5], [1,0.5,0.2] ]
    
    # Color the map slices
    color ramp1010RWB, slice_A
    color ramp11RYG, slice_B
    color ramp55MltGO, slice_C
    
    # Adjust the fineness of the slice color gradations:
    cmd.set('slice_grid',0.1) # normally at 0.3; much finer than 0.05 gets a bit slow
    
    # Map slices can be moved, relative to other fixed objects (e.g., your protein/DNA/RNA), 
    # by turning tracking on (Action menu), and the using the Shift-MouseWheel to move
    # the slice forward in and backward in Z. Adjust fineness of this Z-motion with:
    #   cmd.set('mouse_wheel_scale',0.05) # normally at 0.5
    
    # The result is shown in the image above.
    

## PYMOL API
    
    
     
    cmd.slice_new(string slice_name, string map_name, integer state=0, integer source_state=0)
    

## NOTES

Mis-identified as "slice_map" in documentation. slice or slice_new is the correct command. Documentation also mentions two optional parameters which seem to be no longer supported (opacity = opacity of the new slice, and resolution = the number of pixels per sampling). 

  


## SEE ALSO

[isomesh](/index.php/Isomesh "Isomesh"), [isodot](/index.php/Isodot "Isodot"), [load](/index.php/Load "Load")

## References

  * PyMOL Source code



Retrieved from "[https://pymolwiki.org/index.php?title=Slice&oldid=8954](https://pymolwiki.org/index.php?title=Slice&oldid=8954)"


---

## Slice new

The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.

[![](/images/5/57/Slice_example_2_screenshot.png)](/index.php/File:Slice_example_2_screenshot.png)

[](/index.php/File:Slice_example_2_screenshot.png "Enlarge")

Screenshot of slice example #2

slice creates a slice object from a [map](/index.php?title=Category:Maps&action=edit&redlink=1 "Category:Maps \(page does not exist\)") object. 

## Contents

  * 1 USAGE
  * 2 ARGUMENTS
  * 3 EXAMPLES
  * 4 PYMOL API
  * 5 NOTES
  * 6 SEE ALSO
  * 7 References



## USAGE
    
    
    slice_new name, map, [state, [source_state]]
    

_or_
    
    
    slice name, map, [state, [source_state]]
    

## ARGUMENTS

  * **name** = the name for the new slice object (string)
  * **map** = the name of the map object to use for computing the slice (string)
  * **state** = the state into which the object should be loaded (default=1; set state=0 to append new mesh as a new state)
  * **source_state** = the state of the map from which the object should be loaded (default=0)



## EXAMPLES
    
    
     
    # Create a map slice plane perpendicular to current view
    slice a_new_slice, a_map
    
    
    # A more complicated example that shows how to create multiple slices
    # (in this case, 3 slices perpendicular to each other), each colored
    # with a different color ramp and different contour levels:
    
    # Reset the view, to align view on XYZ axes
    reset
    # (Optional: Adjust view direction to your liking)
    # Create a map slice *perpendicular* to the current view.
    # The slice seems to be in the center of the APBS (or other) volmap. Map "tracking" is off by default.
    slice slice_A, apbs_map
    # Rotate camera 90 degrees about the vertical axis
    turn y, 90
    # Second, perpendicular, slice
    slice slice_B, apbs_map
    # Rotate again, this time about the horizontal
    turn x, 90
    # Third slice
    slice slice_C, apbs_map
    
    # Define new color ramps: ramp_name, map_object, list of low/mid/hi values, 3 RGB triplets
    ramp_new ramp1010RWB, apbs_map, [-10,0,10], [ [1,0,0], [1,1,1], [0,0,1] ]
    ramp_new ramp11RYG, apbs_map, [-1,0,1], [ [1,0,0], [1,1,0], [0,1,0] ]
    ramp_new ramp55MltGO, apbs_map, [-5,0,5], [ [0,1,1], [0.5,1,0.5], [1,0.5,0.2] ]
    
    # Color the map slices
    color ramp1010RWB, slice_A
    color ramp11RYG, slice_B
    color ramp55MltGO, slice_C
    
    # Adjust the fineness of the slice color gradations:
    cmd.set('slice_grid',0.1) # normally at 0.3; much finer than 0.05 gets a bit slow
    
    # Map slices can be moved, relative to other fixed objects (e.g., your protein/DNA/RNA), 
    # by turning tracking on (Action menu), and the using the Shift-MouseWheel to move
    # the slice forward in and backward in Z. Adjust fineness of this Z-motion with:
    #   cmd.set('mouse_wheel_scale',0.05) # normally at 0.5
    
    # The result is shown in the image above.
    

## PYMOL API
    
    
     
    cmd.slice_new(string slice_name, string map_name, integer state=0, integer source_state=0)
    

## NOTES

Mis-identified as "slice_map" in documentation. slice or slice_new is the correct command. Documentation also mentions two optional parameters which seem to be no longer supported (opacity = opacity of the new slice, and resolution = the number of pixels per sampling). 

  


## SEE ALSO

[isomesh](/index.php/Isomesh "Isomesh"), [isodot](/index.php/Isodot "Isodot"), [load](/index.php/Load "Load")

## References

  * PyMOL Source code



Retrieved from "[https://pymolwiki.org/index.php?title=Slice&oldid=8954](https://pymolwiki.org/index.php?title=Slice&oldid=8954)"


---

## SuperSymSource

The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.

This page contains source files for the [SuperSym](/index.php/SuperSym "SuperSym") plugin. For documentation and use instructions, see [SuperSym](/index.php/SuperSym "SuperSym"). 

## Source Code

See <https://github.com/Pymol-Scripts/Pymol-script-repo/blob/master/plugins/SuperSymPlugin.py>

Retrieved from "[https://pymolwiki.org/index.php?title=SuperSymSource&oldid=13314](https://pymolwiki.org/index.php?title=SuperSymSource&oldid=13314)"


---

